[0m08:25:48.726212 [debug] [Thread-1  ]: Began running node model.snowflake_dbt.link_appointment_branch_patient
[0m08:25:48.738098 [info ] [Thread-1  ]: 4 of 7 START sql incremental model raw_vault.link_appointment_branch_patient ... [RUN]
[0m08:25:48.739340 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:48.739741 [debug] [Thread-1  ]: Began compiling node model.snowflake_dbt.link_appointment_branch_patient
[0m08:25:48.740160 [debug] [Thread-1  ]: Compiling model.snowflake_dbt.link_appointment_branch_patient
[0m08:25:48.762214 [info ] [Thread-1  ]: 08:25:48 + Loading TRIAL_LANDING_DB.raw_vault.link_appointment_branch_patient from 1 source(s)
[0m08:25:48.804317 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:48.812785 [debug] [Thread-1  ]: finished collecting timing info
[0m08:25:48.813467 [debug] [Thread-1  ]: Began executing node model.snowflake_dbt.link_appointment_branch_patient
[0m08:25:48.824256 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:48.825040 [debug] [Thread-1  ]: On model.snowflake_dbt.link_appointment_branch_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.link_appointment_branch_patient"} */
create or replace  view TRIAL_LANDING_DB.raw_vault.link_appointment_branch_patient__dbt_tmp
  
   as (
    










    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr."APPOINTMENT_BRANCH_PATIENT_HK", rr."APPOINTMENT_PK", rr."PATIENT_PK", rr."BRANCH_PK", rr."LOAD_DATE", rr."SOURCE_SYSTEM_ID",
           ROW_NUMBER() OVER(
               PARTITION BY rr."APPOINTMENT_BRANCH_PATIENT_HK"
               ORDER BY rr."LOAD_DATE"
           ) AS row_number
    FROM TRIAL_LANDING_DB.stage.appointment_stage AS rr
    WHERE rr."APPOINTMENT_BRANCH_PATIENT_HK" IS NOT NULL
    AND rr."APPOINTMENT_PK" IS NOT NULL
    AND rr."PATIENT_PK" IS NOT NULL
    AND rr."BRANCH_PK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."APPOINTMENT_BRANCH_PATIENT_HK", a."APPOINTMENT_PK", a."PATIENT_PK", a."BRANCH_PK", a."LOAD_DATE", a."SOURCE_SYSTEM_ID"
    FROM row_rank_1 AS a
    LEFT JOIN TRIAL_LANDING_DB.raw_vault.link_appointment_branch_patient AS d
    ON a."APPOINTMENT_BRANCH_PATIENT_HK" = d."APPOINTMENT_BRANCH_PATIENT_HK"
    WHERE d."APPOINTMENT_BRANCH_PATIENT_HK" IS NULL
)

SELECT * FROM records_to_insert
  );
[0m08:25:48.825483 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:25:50.065404 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.24 seconds
[0m08:25:50.072135 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:50.072832 [debug] [Thread-1  ]: On model.snowflake_dbt.link_appointment_branch_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.link_appointment_branch_patient"} */
describe table TRIAL_LANDING_DB.raw_vault.link_appointment_branch_patient__dbt_tmp
[0m08:25:50.595006 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.52 seconds
[0m08:25:50.602038 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:50.602592 [debug] [Thread-1  ]: On model.snowflake_dbt.link_appointment_branch_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.link_appointment_branch_patient"} */
describe table TRIAL_LANDING_DB.raw_vault.link_appointment_branch_patient
[0m08:25:50.779654 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.18 seconds
[0m08:25:50.785506 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:50.786083 [debug] [Thread-1  ]: On model.snowflake_dbt.link_appointment_branch_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.link_appointment_branch_patient"} */
describe table "TRIAL_LANDING_DB"."RAW_VAULT"."LINK_APPOINTMENT_BRANCH_PATIENT"
[0m08:25:51.071918 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.29 seconds
[0m08:25:51.076016 [debug] [Thread-1  ]: Writing runtime sql for node "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:51.086521 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:51.086958 [debug] [Thread-1  ]: On model.snowflake_dbt.link_appointment_branch_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.link_appointment_branch_patient"} */
BEGIN
[0m08:25:51.332610 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.25 seconds
[0m08:25:51.333350 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:51.333878 [debug] [Thread-1  ]: On model.snowflake_dbt.link_appointment_branch_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.link_appointment_branch_patient"} */
insert into TRIAL_LANDING_DB.raw_vault.link_appointment_branch_patient ("APPOINTMENT_BRANCH_PATIENT_HK", "APPOINTMENT_PK", "PATIENT_PK", "BRANCH_PK", "LOAD_DATE", "SOURCE_SYSTEM_ID")
        (
            select "APPOINTMENT_BRANCH_PATIENT_HK", "APPOINTMENT_PK", "PATIENT_PK", "BRANCH_PK", "LOAD_DATE", "SOURCE_SYSTEM_ID"
            from TRIAL_LANDING_DB.raw_vault.link_appointment_branch_patient__dbt_tmp
        );
[0m08:25:52.658126 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.32 seconds
[0m08:25:52.659048 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:52.659695 [debug] [Thread-1  ]: On model.snowflake_dbt.link_appointment_branch_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.link_appointment_branch_patient"} */
COMMIT
[0m08:25:53.025700 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.37 seconds
[0m08:25:53.051245 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.link_appointment_branch_patient"
[0m08:25:53.051882 [debug] [Thread-1  ]: On model.snowflake_dbt.link_appointment_branch_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.link_appointment_branch_patient"} */
drop view if exists TRIAL_LANDING_DB.raw_vault.link_appointment_branch_patient__dbt_tmp cascade
[0m08:25:53.241728 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.19 seconds
[0m08:25:53.244322 [debug] [Thread-1  ]: finished collecting timing info
[0m08:25:53.244905 [debug] [Thread-1  ]: On model.snowflake_dbt.link_appointment_branch_patient: Close
[0m08:25:53.574613 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cf8d89-15bf-47cc-a685-0cb7106b5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0080450>]}
[0m08:25:53.575262 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model raw_vault.link_appointment_branch_patient  [[32mSUCCESS 0[0m in 4.84s]
[0m08:25:53.576074 [debug] [Thread-1  ]: Finished running node model.snowflake_dbt.link_appointment_branch_patient
[0m08:25:53.576496 [debug] [Thread-1  ]: Began running node model.snowflake_dbt.sat_appointment
[0m08:25:53.577012 [info ] [Thread-1  ]: 5 of 7 START sql vault_insert_by_period model raw_vault.sat_appointment ........ [RUN]
[0m08:25:53.578024 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.snowflake_dbt.sat_appointment"
[0m08:25:53.578405 [debug] [Thread-1  ]: Began compiling node model.snowflake_dbt.sat_appointment
[0m08:25:53.578782 [debug] [Thread-1  ]: Compiling model.snowflake_dbt.sat_appointment
[0m08:25:53.660488 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_dbt.sat_appointment"
[0m08:25:53.671102 [debug] [Thread-1  ]: finished collecting timing info
[0m08:25:53.671622 [debug] [Thread-1  ]: Began executing node model.snowflake_dbt.sat_appointment
[0m08:25:53.807829 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_appointment"
[0m08:25:53.808403 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_appointment: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_appointment"} */
WITH period_data AS (
            SELECT
                COALESCE(MAX("LOAD_DATE"), '2022-09-19')::TIMESTAMP AS start_timestamp,
                COALESCE(

    dateadd(
        millisecond,
        86399999,
        NULLIF('2022-09-23','none')::TIMESTAMP
        )

,
                         
    
    current_timestamp::
    timestamp_ntz


 ) AS stop_timestamp
            FROM TRIAL_LANDING_DB.raw_vault.sat_appointment
        )
        SELECT
            start_timestamp,
            stop_timestamp,
            datediff(
        day,
        start_timestamp,
        stop_timestamp
        ) + 1 AS num_periods
        FROM period_data
[0m08:25:53.808859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:25:54.908109 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.1 seconds
[0m08:25:54.914819 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_appointment"
[0m08:25:54.915475 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_appointment: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_appointment"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_appointment
[0m08:25:55.097033 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.18 seconds
[0m08:25:55.113754 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_appointment"
[0m08:25:55.114379 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_appointment: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_appointment"} */
SELECT DATE_TRUNC('day', DATEADD(day, 0, TO_DATE('2022-09-23 00:00:00'))) AS period_of_load
[0m08:25:55.301582 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.19 seconds
[0m08:25:55.305318 [info ] [Thread-1  ]: 08:25:55 + Running for day 1 of 1 (2022-09-23) [model.snowflake_dbt.sat_appointment]
[0m08:25:55.355450 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_appointment"
[0m08:25:55.355921 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_appointment: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_appointment"} */
create or replace temporary table TRIAL_LANDING_DB.raw_vault.sat_appointment__dbt_tmp  as
        (select "APPOINTMENT_PK", "APPOINTMENT_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID" from (










-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a."APPOINTMENT_PK", a."APPOINTMENT_HASHDIFF", a."EFFECTIVE_FROM", a."LOAD_DATE", a."SOURCE_SYSTEM_ID"
    FROM TRIAL_LANDING_DB.stage.appointment_stage AS a
    WHERE a."APPOINTMENT_PK" IS NOT NULL
    AND (TO_DATE("LOAD_DATE")
        >= DATE_TRUNC('day', TO_DATE('2022-09-23 00:00:00') + INTERVAL '0 day') AND
             TO_DATE("LOAD_DATE") < DATE_TRUNC('day', TO_DATE('2022-09-23 00:00:00') + INTERVAL '0 day' + INTERVAL '1 day'))
      AND (TO_DATE("LOAD_DATE") >= TO_DATE('2022-09-23 00:00:00'))
    
),



latest_records AS (
    SELECT a."APPOINTMENT_PK", a."APPOINTMENT_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."APPOINTMENT_PK", current_records."APPOINTMENT_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
               PARTITION BY current_records."APPOINTMENT_PK"
               ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM TRIAL_LANDING_DB.raw_vault.sat_appointment AS current_records
            JOIN (
                SELECT DISTINCT source_data."APPOINTMENT_PK"
                FROM source_data
            ) AS source_records
                ON current_records."APPOINTMENT_PK" = source_records."APPOINTMENT_PK"
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage."APPOINTMENT_PK", stage."APPOINTMENT_HASHDIFF", stage."EFFECTIVE_FROM", stage."LOAD_DATE", stage."SOURCE_SYSTEM_ID"
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records."APPOINTMENT_PK" = stage."APPOINTMENT_PK"
        AND latest_records."APPOINTMENT_HASHDIFF" = stage."APPOINTMENT_HASHDIFF"
    WHERE latest_records."APPOINTMENT_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert)
        );
[0m08:25:57.743344 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.39 seconds
[0m08:25:57.748856 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_appointment"
[0m08:25:57.749438 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_appointment: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_appointment"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_appointment__dbt_tmp
[0m08:25:57.940597 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.19 seconds
[0m08:25:57.950481 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_appointment"
[0m08:25:57.951275 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_appointment: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_appointment"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_appointment
[0m08:25:58.151990 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.2 seconds
[0m08:25:58.156416 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_appointment"
[0m08:25:58.157136 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_appointment: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_appointment"} */
INSERT INTO TRIAL_LANDING_DB.raw_vault.sat_appointment ("APPOINTMENT_PK", "APPOINTMENT_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID")
                (
                    SELECT "APPOINTMENT_PK", "APPOINTMENT_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID"
                    FROM TRIAL_LANDING_DB.raw_vault.sat_appointment__dbt_tmp
                );
[0m08:25:58.423578 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.27 seconds
[0m08:25:58.428260 [info ] [Thread-1  ]: 08:25:58 + Ran for day 1 of 1 (2022-09-23); 0 records inserted [model.snowflake_dbt.sat_appointment]
[0m08:25:58.436968 [debug] [Thread-1  ]: Writing runtime SQL for node "model.snowflake_dbt.sat_appointment"
[0m08:25:58.449173 [debug] [Thread-1  ]: finished collecting timing info
[0m08:25:58.449909 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_appointment: Close
[0m08:25:58.801233 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cf8d89-15bf-47cc-a685-0cb7106b5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0080a10>]}
[0m08:25:58.803649 [info ] [Thread-1  ]: 5 of 7 OK created sql vault_insert_by_period model raw_vault.sat_appointment ... [[32mINSERT 0[0m in 5.22s]
[0m08:25:58.807503 [debug] [Thread-1  ]: Finished running node model.snowflake_dbt.sat_appointment
[0m08:25:58.809537 [debug] [Thread-1  ]: Began running node model.snowflake_dbt.sat_branch
[0m08:25:58.811489 [info ] [Thread-1  ]: 6 of 7 START sql vault_insert_by_period model raw_vault.sat_branch ............. [RUN]
[0m08:25:58.813679 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:25:58.814689 [debug] [Thread-1  ]: Began compiling node model.snowflake_dbt.sat_branch
[0m08:25:58.815595 [debug] [Thread-1  ]: Compiling model.snowflake_dbt.sat_branch
[0m08:25:58.859949 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_dbt.sat_branch"
[0m08:25:58.879892 [debug] [Thread-1  ]: finished collecting timing info
[0m08:25:58.880879 [debug] [Thread-1  ]: Began executing node model.snowflake_dbt.sat_branch
[0m08:25:58.894303 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:25:58.894917 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
WITH period_data AS (
            SELECT
                COALESCE(MAX("LOAD_DATE"), '2022-09-24')::TIMESTAMP AS start_timestamp,
                COALESCE(

    dateadd(
        millisecond,
        86399999,
        NULLIF('2022-09-25','none')::TIMESTAMP
        )

,
                         
    
    current_timestamp::
    timestamp_ntz


 ) AS stop_timestamp
            FROM TRIAL_LANDING_DB.raw_vault.sat_branch
        )
        SELECT
            start_timestamp,
            stop_timestamp,
            datediff(
        day,
        start_timestamp,
        stop_timestamp
        ) + 1 AS num_periods
        FROM period_data
[0m08:25:58.895633 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:26:00.263207 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.37 seconds
[0m08:26:00.401488 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:00.402246 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_branch
[0m08:26:00.591904 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.19 seconds
[0m08:26:00.597044 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:00.597845 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
SELECT DATE_TRUNC('day', DATEADD(day, 0, TO_DATE('2022-09-24 00:00:00'))) AS period_of_load
[0m08:26:00.776804 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m08:26:00.780408 [info ] [Thread-1  ]: 08:26:00 + Running for day 1 of 2 (2022-09-24) [model.snowflake_dbt.sat_branch]
[0m08:26:00.784750 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:00.785404 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
create or replace temporary table TRIAL_LANDING_DB.raw_vault.sat_branch__dbt_tmp  as
        (select "BRANCH_PK", "BRANCH_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID" from (










-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a."BRANCH_PK", a."BRANCH_HASHDIFF", a."EFFECTIVE_FROM", a."LOAD_DATE", a."SOURCE_SYSTEM_ID"
    FROM TRIAL_LANDING_DB.stage.branch_stage AS a
    WHERE a."BRANCH_PK" IS NOT NULL
    AND (TO_DATE("LOAD_DATE")
        >= DATE_TRUNC('day', TO_DATE('2022-09-24 00:00:00') + INTERVAL '0 day') AND
             TO_DATE("LOAD_DATE") < DATE_TRUNC('day', TO_DATE('2022-09-24 00:00:00') + INTERVAL '0 day' + INTERVAL '1 day'))
      AND (TO_DATE("LOAD_DATE") >= TO_DATE('2022-09-24 00:00:00'))
    
),



latest_records AS (
    SELECT a."BRANCH_PK", a."BRANCH_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."BRANCH_PK", current_records."BRANCH_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
               PARTITION BY current_records."BRANCH_PK"
               ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM TRIAL_LANDING_DB.raw_vault.sat_branch AS current_records
            JOIN (
                SELECT DISTINCT source_data."BRANCH_PK"
                FROM source_data
            ) AS source_records
                ON current_records."BRANCH_PK" = source_records."BRANCH_PK"
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage."BRANCH_PK", stage."BRANCH_HASHDIFF", stage."EFFECTIVE_FROM", stage."LOAD_DATE", stage."SOURCE_SYSTEM_ID"
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records."BRANCH_PK" = stage."BRANCH_PK"
        AND latest_records."BRANCH_HASHDIFF" = stage."BRANCH_HASHDIFF"
    WHERE latest_records."BRANCH_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert)
        );
[0m08:26:05.182276 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.4 seconds
[0m08:26:05.188391 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:05.189364 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_branch__dbt_tmp
[0m08:26:05.383534 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.19 seconds
[0m08:26:05.391385 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:05.392078 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_branch
[0m08:26:05.612460 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.22 seconds
[0m08:26:05.616919 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:05.617846 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
INSERT INTO TRIAL_LANDING_DB.raw_vault.sat_branch ("BRANCH_PK", "BRANCH_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID")
                (
                    SELECT "BRANCH_PK", "BRANCH_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID"
                    FROM TRIAL_LANDING_DB.raw_vault.sat_branch__dbt_tmp
                );
[0m08:26:05.889211 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.27 seconds
[0m08:26:05.892626 [info ] [Thread-1  ]: 08:26:05 + Ran for day 1 of 2 (2022-09-24); 0 records inserted [model.snowflake_dbt.sat_branch]
[0m08:26:05.895293 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:05.895868 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
SELECT DATE_TRUNC('day', DATEADD(day, 1, TO_DATE('2022-09-24 00:00:00'))) AS period_of_load
[0m08:26:06.073777 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m08:26:06.078238 [info ] [Thread-1  ]: 08:26:06 + Running for day 2 of 2 (2022-09-25) [model.snowflake_dbt.sat_branch]
[0m08:26:06.083416 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:06.084095 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
create or replace temporary table TRIAL_LANDING_DB.raw_vault.sat_branch__dbt_tmp  as
        (select "BRANCH_PK", "BRANCH_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID" from (










-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a."BRANCH_PK", a."BRANCH_HASHDIFF", a."EFFECTIVE_FROM", a."LOAD_DATE", a."SOURCE_SYSTEM_ID"
    FROM TRIAL_LANDING_DB.stage.branch_stage AS a
    WHERE a."BRANCH_PK" IS NOT NULL
    AND (TO_DATE("LOAD_DATE")
        >= DATE_TRUNC('day', TO_DATE('2022-09-24 00:00:00') + INTERVAL '1 day') AND
             TO_DATE("LOAD_DATE") < DATE_TRUNC('day', TO_DATE('2022-09-24 00:00:00') + INTERVAL '1 day' + INTERVAL '1 day'))
      AND (TO_DATE("LOAD_DATE") >= TO_DATE('2022-09-24 00:00:00'))
    
),



latest_records AS (
    SELECT a."BRANCH_PK", a."BRANCH_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."BRANCH_PK", current_records."BRANCH_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
               PARTITION BY current_records."BRANCH_PK"
               ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM TRIAL_LANDING_DB.raw_vault.sat_branch AS current_records
            JOIN (
                SELECT DISTINCT source_data."BRANCH_PK"
                FROM source_data
            ) AS source_records
                ON current_records."BRANCH_PK" = source_records."BRANCH_PK"
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage."BRANCH_PK", stage."BRANCH_HASHDIFF", stage."EFFECTIVE_FROM", stage."LOAD_DATE", stage."SOURCE_SYSTEM_ID"
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records."BRANCH_PK" = stage."BRANCH_PK"
        AND latest_records."BRANCH_HASHDIFF" = stage."BRANCH_HASHDIFF"
    WHERE latest_records."BRANCH_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert)
        );
[0m08:26:10.312843 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.23 seconds
[0m08:26:10.324469 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:10.325145 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_branch__dbt_tmp
[0m08:26:10.519732 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.19 seconds
[0m08:26:10.529428 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:10.530244 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_branch
[0m08:26:10.734540 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.2 seconds
[0m08:26:10.737335 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_branch"
[0m08:26:10.737822 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_branch"} */
INSERT INTO TRIAL_LANDING_DB.raw_vault.sat_branch ("BRANCH_PK", "BRANCH_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID")
                (
                    SELECT "BRANCH_PK", "BRANCH_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID"
                    FROM TRIAL_LANDING_DB.raw_vault.sat_branch__dbt_tmp
                );
[0m08:26:11.022216 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.28 seconds
[0m08:26:11.024569 [info ] [Thread-1  ]: 08:26:11 + Ran for day 2 of 2 (2022-09-25); 0 records inserted [model.snowflake_dbt.sat_branch]
[0m08:26:11.025525 [debug] [Thread-1  ]: Writing runtime SQL for node "model.snowflake_dbt.sat_branch"
[0m08:26:11.035819 [debug] [Thread-1  ]: finished collecting timing info
[0m08:26:11.036368 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_branch: Close
[0m08:26:11.384031 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cf8d89-15bf-47cc-a685-0cb7106b5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5badf2b10>]}
[0m08:26:11.384836 [info ] [Thread-1  ]: 6 of 7 OK created sql vault_insert_by_period model raw_vault.sat_branch ........ [[32mINSERT 0[0m in 12.57s]
[0m08:26:11.385800 [debug] [Thread-1  ]: Finished running node model.snowflake_dbt.sat_branch
[0m08:26:11.386459 [debug] [Thread-1  ]: Began running node model.snowflake_dbt.sat_patient
[0m08:26:11.387101 [info ] [Thread-1  ]: 7 of 7 START sql vault_insert_by_period model raw_vault.sat_patient ............ [RUN]
[0m08:26:11.388249 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:11.388790 [debug] [Thread-1  ]: Began compiling node model.snowflake_dbt.sat_patient
[0m08:26:11.389346 [debug] [Thread-1  ]: Compiling model.snowflake_dbt.sat_patient
[0m08:26:11.410855 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_dbt.sat_patient"
[0m08:26:11.424455 [debug] [Thread-1  ]: finished collecting timing info
[0m08:26:11.425178 [debug] [Thread-1  ]: Began executing node model.snowflake_dbt.sat_patient
[0m08:26:11.435977 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:11.436660 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
WITH period_data AS (
            SELECT
                COALESCE(MAX("LOAD_DATE"), '2022-09-24')::TIMESTAMP AS start_timestamp,
                COALESCE(

    dateadd(
        millisecond,
        86399999,
        NULLIF('2022-09-25','none')::TIMESTAMP
        )

,
                         
    
    current_timestamp::
    timestamp_ntz


 ) AS stop_timestamp
            FROM TRIAL_LANDING_DB.raw_vault.sat_patient
        )
        SELECT
            start_timestamp,
            stop_timestamp,
            datediff(
        day,
        start_timestamp,
        stop_timestamp
        ) + 1 AS num_periods
        FROM period_data
[0m08:26:11.437136 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:26:12.329939 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.89 seconds
[0m08:26:12.336634 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:12.337163 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_patient
[0m08:26:12.511454 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.17 seconds
[0m08:26:12.514880 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:12.515533 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
SELECT DATE_TRUNC('day', DATEADD(day, 0, TO_DATE('2022-09-24 00:00:00'))) AS period_of_load
[0m08:26:12.696895 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m08:26:12.699926 [info ] [Thread-1  ]: 08:26:12 + Running for day 1 of 2 (2022-09-24) [model.snowflake_dbt.sat_patient]
[0m08:26:12.703980 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:12.704435 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
create or replace temporary table TRIAL_LANDING_DB.raw_vault.sat_patient__dbt_tmp  as
        (select "PATIENT_PK", "PATIENT_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID" from (










-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a."PATIENT_PK", a."PATIENT_HASHDIFF", a."EFFECTIVE_FROM", a."LOAD_DATE", a."SOURCE_SYSTEM_ID"
    FROM TRIAL_LANDING_DB.stage.patient_stage AS a
    WHERE a."PATIENT_PK" IS NOT NULL
    AND (TO_DATE("LOAD_DATE")
        >= DATE_TRUNC('day', TO_DATE('2022-09-24 00:00:00') + INTERVAL '0 day') AND
             TO_DATE("LOAD_DATE") < DATE_TRUNC('day', TO_DATE('2022-09-24 00:00:00') + INTERVAL '0 day' + INTERVAL '1 day'))
      AND (TO_DATE("LOAD_DATE") >= TO_DATE('2022-09-24 00:00:00'))
    
),



latest_records AS (
    SELECT a."PATIENT_PK", a."PATIENT_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."PATIENT_PK", current_records."PATIENT_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
               PARTITION BY current_records."PATIENT_PK"
               ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM TRIAL_LANDING_DB.raw_vault.sat_patient AS current_records
            JOIN (
                SELECT DISTINCT source_data."PATIENT_PK"
                FROM source_data
            ) AS source_records
                ON current_records."PATIENT_PK" = source_records."PATIENT_PK"
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage."PATIENT_PK", stage."PATIENT_HASHDIFF", stage."EFFECTIVE_FROM", stage."LOAD_DATE", stage."SOURCE_SYSTEM_ID"
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records."PATIENT_PK" = stage."PATIENT_PK"
        AND latest_records."PATIENT_HASHDIFF" = stage."PATIENT_HASHDIFF"
    WHERE latest_records."PATIENT_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert)
        );
[0m08:26:18.090692 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.39 seconds
[0m08:26:18.096181 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:18.096800 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_patient__dbt_tmp
[0m08:26:18.285212 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.19 seconds
[0m08:26:18.291511 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:18.292033 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_patient
[0m08:26:18.481338 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.19 seconds
[0m08:26:18.484232 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:18.484862 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
INSERT INTO TRIAL_LANDING_DB.raw_vault.sat_patient ("PATIENT_PK", "PATIENT_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID")
                (
                    SELECT "PATIENT_PK", "PATIENT_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID"
                    FROM TRIAL_LANDING_DB.raw_vault.sat_patient__dbt_tmp
                );
[0m08:26:18.759139 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.27 seconds
[0m08:26:18.763151 [info ] [Thread-1  ]: 08:26:18 + Ran for day 1 of 2 (2022-09-24); 0 records inserted [model.snowflake_dbt.sat_patient]
[0m08:26:18.765464 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:18.766116 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
SELECT DATE_TRUNC('day', DATEADD(day, 1, TO_DATE('2022-09-24 00:00:00'))) AS period_of_load
[0m08:26:18.942067 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.18 seconds
[0m08:26:18.944667 [info ] [Thread-1  ]: 08:26:18 + Running for day 2 of 2 (2022-09-25) [model.snowflake_dbt.sat_patient]
[0m08:26:18.948710 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:18.949266 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
create or replace temporary table TRIAL_LANDING_DB.raw_vault.sat_patient__dbt_tmp  as
        (select "PATIENT_PK", "PATIENT_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID" from (










-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a."PATIENT_PK", a."PATIENT_HASHDIFF", a."EFFECTIVE_FROM", a."LOAD_DATE", a."SOURCE_SYSTEM_ID"
    FROM TRIAL_LANDING_DB.stage.patient_stage AS a
    WHERE a."PATIENT_PK" IS NOT NULL
    AND (TO_DATE("LOAD_DATE")
        >= DATE_TRUNC('day', TO_DATE('2022-09-24 00:00:00') + INTERVAL '1 day') AND
             TO_DATE("LOAD_DATE") < DATE_TRUNC('day', TO_DATE('2022-09-24 00:00:00') + INTERVAL '1 day' + INTERVAL '1 day'))
      AND (TO_DATE("LOAD_DATE") >= TO_DATE('2022-09-24 00:00:00'))
    
),



latest_records AS (
    SELECT a."PATIENT_PK", a."PATIENT_HASHDIFF", a."LOAD_DATE"
    FROM (
        SELECT current_records."PATIENT_PK", current_records."PATIENT_HASHDIFF", current_records."LOAD_DATE",
            RANK() OVER (
               PARTITION BY current_records."PATIENT_PK"
               ORDER BY current_records."LOAD_DATE" DESC
            ) AS rank
        FROM TRIAL_LANDING_DB.raw_vault.sat_patient AS current_records
            JOIN (
                SELECT DISTINCT source_data."PATIENT_PK"
                FROM source_data
            ) AS source_records
                ON current_records."PATIENT_PK" = source_records."PATIENT_PK"
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage."PATIENT_PK", stage."PATIENT_HASHDIFF", stage."EFFECTIVE_FROM", stage."LOAD_DATE", stage."SOURCE_SYSTEM_ID"
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records."PATIENT_PK" = stage."PATIENT_PK"
        AND latest_records."PATIENT_HASHDIFF" = stage."PATIENT_HASHDIFF"
    WHERE latest_records."PATIENT_HASHDIFF" IS NULL
)

SELECT * FROM records_to_insert)
        );
[0m08:26:21.684005 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.73 seconds
[0m08:26:21.690292 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:21.691090 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_patient__dbt_tmp
[0m08:26:21.878235 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.19 seconds
[0m08:26:21.884143 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:21.884681 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
describe table TRIAL_LANDING_DB.raw_vault.sat_patient
[0m08:26:22.059859 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.17 seconds
[0m08:26:22.063091 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_dbt.sat_patient"
[0m08:26:22.063730 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_vault", "target_name": "dev", "node_id": "model.snowflake_dbt.sat_patient"} */
INSERT INTO TRIAL_LANDING_DB.raw_vault.sat_patient ("PATIENT_PK", "PATIENT_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID")
                (
                    SELECT "PATIENT_PK", "PATIENT_HASHDIFF", "EFFECTIVE_FROM", "LOAD_DATE", "SOURCE_SYSTEM_ID"
                    FROM TRIAL_LANDING_DB.raw_vault.sat_patient__dbt_tmp
                );
[0m08:26:22.382658 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.32 seconds
[0m08:26:22.386285 [info ] [Thread-1  ]: 08:26:22 + Ran for day 2 of 2 (2022-09-25); 0 records inserted [model.snowflake_dbt.sat_patient]
[0m08:26:22.387834 [debug] [Thread-1  ]: Writing runtime SQL for node "model.snowflake_dbt.sat_patient"
[0m08:26:22.398144 [debug] [Thread-1  ]: finished collecting timing info
[0m08:26:22.398827 [debug] [Thread-1  ]: On model.snowflake_dbt.sat_patient: Close
[0m08:26:22.744465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cf8d89-15bf-47cc-a685-0cb7106b5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c1454a50>]}
[0m08:26:22.745521 [info ] [Thread-1  ]: 7 of 7 OK created sql vault_insert_by_period model raw_vault.sat_patient ....... [[32mINSERT 0[0m in 11.36s]
[0m08:26:22.746428 [debug] [Thread-1  ]: Finished running node model.snowflake_dbt.sat_patient
[0m08:26:22.841643 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m08:26:22.842773 [info ] [MainThread]: 
[0m08:26:22.843603 [info ] [MainThread]: Finished running 4 incremental models, 3 vault_insert_by_period models in 0 hours 0 minutes and 56.25 seconds (56.25s).
[0m08:26:22.844433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:26:22.845006 [debug] [MainThread]: Connection 'model.snowflake_dbt.sat_patient' was properly closed.
[0m08:26:22.915787 [info ] [MainThread]: 
[0m08:26:22.916546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:26:22.917402 [info ] [MainThread]: 
[0m08:26:22.918099 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m08:26:22.919176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0130e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0068b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0068d90>]}
[0m08:26:22.919913 [debug] [MainThread]: Flushing usage events
